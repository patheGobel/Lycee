name: Gather All PDFs to Docs Directory

# Le workflow s'exécute après chaque 'push' sur la branche 'main' et manuellement
on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  gather_and_deploy:
    runs-on: ubuntu-latest
    
    steps:
      # Étape 1 : Récupérer le code de votre dépôt
      - name: Checkout repository
        uses: actions/checkout@v4

      # Étape 2 : Créer le dossier de destination pour les PDF et le fichier .nojekyll
      - name: Setup docs directory
        run: |
          mkdir -p docs/pdf
          touch docs/.nojekyll

      # Étape 3 : Trouver TOUS les PDF dans le dépôt et les déplacer vers docs/pdf
      - name: Locate and Move All PDFs
        run: |
          echo "Démarrage du déplacement de tous les PDF vers docs/pdf..."
          
          # La commande FIND cherche tous les fichiers .pdf (y compris dans les sous-dossiers 'build')
          # et les déplace tous dans le répertoire docs/pdf/.
          # Le chemin de destination n'a pas besoin d'être spécifié si le nom du fichier est conservé.
          find . -type f -name "*.pdf" -exec mv {} docs/pdf/ \;
          
          echo "Contenu de docs/pdf/ (vérification) :"
          ls docs/pdf/

      # Étape 4 : Déployer le site via GitHub Pages
      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        if: success()
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./docs