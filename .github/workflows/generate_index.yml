name: Generate PDF index

on:
  push:
    branches:
      - gh-pages  # Ce workflow s‚Äôex√©cute quand les PDF sont d√©ploy√©s

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout gh-pages branch
        uses: actions/checkout@v4
        with:
          ref: gh-pages

      - name: Generate index.html
        run: |
          echo "<!DOCTYPE html>" > index.html
          echo "<html lang='fr'><head><meta charset='UTF-8'><title>Cours du Lyc√©e</title></head><body>" >> index.html
          echo "<h1>üìò Cours disponibles</h1><ul>" >> index.html
          for f in $(find . -type f -name "*.pdf" | sort); do
            name=$(basename "$f")
            echo "<li><a href='$name'>$name</a></li>" >> index.html
          done
          echo "</ul><hr><p style='font-size:12px'>Site g√©n√©r√© automatiquement par GitHub Actions</p></body></html>" >> index.html

      - name: Commit and push updated index
        run: |
          git config user.name "github-actions"
          git config user.email "actions@github.com"
          git add index.html
          git commit -m "Mise √† jour automatique de l‚Äôindex PDF" || echo "Aucun changement"
          git push origin gh-pages
